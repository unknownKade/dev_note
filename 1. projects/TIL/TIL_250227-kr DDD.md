### 도메인 주도

- RDS 관점에서 연관 관계가 맞지만 객체 관점에서 맞는지 고민이 필요
- 도메인 관점의 설계 -> 도메인 개념/구현 모델
![[Pasted image 20250227151229.png]]

![[Pasted image 20250227151327.png]]

- 연관관계인데 라이프 사이클이 다를 수 있다
	- 생명주기가 같으면 종속적인 관계 -> 주문을 만들 때 주문 아이템이 만들어진다
	- 생명주기각 다르면 독립적인 관계 -> 주문 아이템 만들 때 상품이 만들어지지 않는다
![[Pasted image 20250227151921.png]]
- 복잡성 대응은 도메인 별 계층
![[Pasted image 20250227152002.png]]



### 바운디드 컨텍스트
- 시스템을 여러 작은 컨텍스트로 나눔
- 컨텍스트 간에는 인터네핑스를 통해 상호작용
- 바운디드 컨텍스트 안에서 용어, 개념,규칙을 공유한다
- 바운디드 컨텍스트는 독립적으로 동작하도록 설계한다

- 컨텍스트를 분리하고 외부 컨텍스트와 소통할 때는 API를 사용
![[Pasted image 20250227152326.png]]

- 컨텍스트 안에서 계층 나눔
	- 으용 계층을
![[Pasted image 20250227152425.png]]

- 패키지 분리(모놀리식)
	- Rest, Service/Facade으로 통신
	- 옛니는 파사드
![[Pasted image 20250227152708.png]]
- API를 통해
![[Pasted image 20250227152733.png]]


- 공통 모듈
![[Pasted image 20250227152843.png]]

### 애그리거트 루트
- 애그리거트 : 도메인 모델에서 논리적인 단위 (객체들의 집합)
	- 같이 라이프 사이클을 공유하는 단위
	- 도메인 모델 내에서 일관성을 갖는 객체들
- 애그리거트 루트: 애그리거트를 대표하는 객체로 그 집합의 유일한 진입점(entry point)역으로 설정
	- 데이터 일관성 유지 -> 오직 루트로만 데이터 변경 (오더 상세는 오더 객체로만 수정)
	- 변경 범위(트랜잭션) 제어 -> 같은 애그리거트 안에선 한 트랜잭션으로 처리 
	- 
	- 엔티티 간 직접 참조를 방지 -> 결합도 낮춤
	- 데이터 저장소(Repository)와의 관계 정리
- 컨텍스트는 애그리거트의 더 큰 개념. 한 컨텍스트 안에 여러 애그리거트 있을 수 있음 (주문 다른 애그리거트 있을 수 있음)
![[Pasted image 20250227153348.png]]

- DDD 적용시 동시성이나 조회성능(자식들 다 조회해서 들고 올까봐) 신경 많이 써야할거같은데 팁이 있을까요?
	- 동시성은 MSA 라면 분산 락 + 낙관 락 조합, 조회는 LAZY 전략이나 쿼리 최적화 신경쓰는 방법이 있지 않을까요?


- [객체 설계](draw.io)해보기